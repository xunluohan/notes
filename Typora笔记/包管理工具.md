## NPM

### ä»‹ç»

å…¨ç§°ï¼šNode Package Manager , Node çš„åŒ…ç®¡ç†å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚

### åŒ…æ˜¯ä»€ä¹ˆ

Node.js çš„åŒ…åŸºæœ¬éµå¾ª CommonJS è§„èŒƒï¼Œå°†ä¸€ç»„ç›¸å…³çš„æ¨¡å—ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å·¥å…·

### ä½œç”¨

é€šè¿‡ NPM å¯ä»¥å¯¹ Node çš„å·¥å…·åŒ…è¿›è¡Œæœç´¢ã€ä¸‹è½½ã€å®‰è£…ã€åˆ é™¤ã€ä¸Šä¼ ã€‚å€ŸåŠ©åˆ«äººå†™å¥½çš„åŒ…ï¼Œå¯ä»¥è®©æˆ‘ä»¬çš„å¼€å‘æ›´åŠ æ–¹ä¾¿ã€‚

### å®‰è£…

å®‰è£…å®Œ nodejs ä¹‹åä¼šè‡ªåŠ¨å®‰è£… npm

### å¸¸ç”¨å‘½ä»¤

#### æŸ¥çœ‹ npm çš„ç‰ˆæœ¬

```sh
npm -v 
```

#### åˆå§‹åŒ–

```sh
npm init
npm init --yes   or   npm init -y
```

è¿è¡Œåä¼šåˆ›å»º package.json æ–‡ä»¶             

```json
{
  "name": "1-npm",      #åŒ…çš„åå­—
  "version": "1.0.0",   #åŒ…çš„ç‰ˆæœ¬
  "description": "",    #åŒ…çš„æè¿°
  "main": "index.js",   #åŒ…çš„å…¥å£æ–‡ä»¶
  "scripts": {			#è„šæœ¬é…ç½®
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",			#ä½œè€…
  "license": "ISC"		#ç‰ˆæƒå£°æ˜
}
```

> ==æ³¨æ„ç”Ÿæˆçš„åŒ…åä¸èƒ½ä½¿ç”¨ä¸­æ–‡ï¼Œå¤§å†™ ï¼ï¼ï¼ ä¸èƒ½ä½¿ç”¨ npm ä½œä¸ºåŒ…çš„åå­—==

å…³äºå¼€æºè¯ä¹¦æ‰©å±•é˜…è¯»

<http://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html>

#### æœç´¢åŒ…

ä¸€èˆ¬åœ¨æœç´¢å·¥å…·åŒ…çš„æ—¶å€™ï¼Œä¼šåˆ° https://npmjs.org æœç´¢

#### å®‰è£…å·¥å…·åŒ…

```sh
npm install jquery
npm i jquery

# å®‰è£…å¹¶åœ¨ package.json ä¸­ä¿å­˜åŒ…çš„ä¿¡æ¯(dependencies å±æ€§)
npm install jquery --save
npm install jquery -S

# å®‰è£…å¹¶åœ¨ package.json ä¸­ä¿å­˜åŒ…çš„ä¿¡æ¯(devDependencies å±æ€§)
npm install babel --save-dev
npm install babel -D
```

>  6 ç‰ˆæœ¬çš„ npm ï¼Œå®‰è£…åŒ…æ—¶ä¼šè‡ªåŠ¨ä¿å­˜åœ¨ dependencies ä¸­ï¼Œå¯ä»¥ä¸ç”¨å†™ --save

#### å…¨å±€å®‰è£…

```sh
npm install less -g
npm install nodemon -g 
```

å…¨å±€å®‰è£…ä¸€èˆ¬ç”¨äºå®‰è£…å…¨å±€å·¥å…·ï¼Œå¦‚ cnpmï¼Œyarnï¼Œwebpack ï¼Œgulpç­‰ï¼Œå…¨å±€å‘½ä»¤çš„å®‰è£…ä½ç½®

```
C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\npm    # npm root -g
```

> å…¨å±€å®‰è£…å‘½ä»¤åœ¨ä»»æ„çš„å‘½ä»¤è¡Œä¸‹, éƒ½å¯ä»¥æ‰§è¡Œ

#### å®‰è£…ä¾èµ–

æ ¹æ® package.json ä¸­çš„ä¾èµ–å£°æ˜ï¼Œ å®‰è£…å·¥å…·åŒ…

```sh
npm i
npm install
```

#### ç§»é™¤åŒ…

```sh
npm remove jquery
```

### ä½¿ç”¨æµç¨‹

å›¢é˜Ÿå¼€å‘æ—¶ä½¿ç”¨æµç¨‹

1. ä»ä»“åº“ä¸­æ‹‰å–ä»“åº“ä»£ç 
2. ==è¿è¡Œ npm install å®‰è£…ç›¸å…³ä¾èµ–==
3. è¿è¡Œé¡¹ç›®ï¼Œç»§ç»­å¼€å‘

### å°è£… NPM åŒ…

åˆ›å»ºè‡ªå·±çš„ NPM åŒ…å¯ä»¥å¸®åŠ©ä»£ç è¿›è¡Œè¿­ä»£è¿›åŒ–ï¼Œä½¿ç”¨æ­¥éª¤ä¹Ÿæ¯”è¾ƒç®€å•

0. ä¿®æ”¹ä¸ºå®˜æ–¹çš„åœ°å€ (npm config set registry https://registry.npmjs.org/)

1. åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºæ–‡ä»¶ index.jsï¼Œ åœ¨æ–‡ä»¶ä¸­å£°æ˜å‡½æ•°ï¼Œä½¿ç”¨ module.exports æš´éœ²
2. npm initåˆå§‹åŒ–å·¥å…·åŒ…ï¼Œpackage.json å¡«å†™åŒ…çš„ä¿¡æ¯
3. è´¦å·æ³¨å†Œï¼ˆæ¿€æ´»è´¦å·ï¼‰,==å®Œæˆé‚®ç®±éªŒè¯==
4. å‘½ä»¤è¡Œä¸‹ ã€npm loginã€ å¡«å†™ç›¸å…³ç”¨æˆ·ä¿¡æ¯
5. å‘½ä»¤è¡Œä¸‹ã€ npm publishã€ æäº¤åŒ… ğŸ‘Œ

> npm æœ‰åƒåœ¾æ£€æµ‹æœºåˆ¶ï¼Œå¦‚æœåå­—ç®€å•æˆ–åšæµ‹è¯•æäº¤ï¼Œå¾ˆå¯èƒ½ä¼šè¢«æ‹’ç»æäº¤
>
> ==å¯ä»¥å°è¯•æ”¹ä¸€ä¸‹åŒ…çš„åç§°æ¥è§£å†³è¿™ä¸ªé—®é¢˜==

å‡çº§ NPM åŒ…ï¼Œéœ€è¦ä¿®æ”¹ package.json ä¸­çš„ç‰ˆæœ¬å·ä¿®æ”¹ï¼Œåªéœ€è¦æ‰§è¡Œã€npm publishã€å°±å¯ä»¥èƒ½æäº¤

1. ä¿®æ”¹åŒ…ä»£ç 
2. ä¿®æ”¹ package.json ä¸­ç‰ˆæœ¬å·
3. npm publish æäº¤

### åˆ é™¤ npm åŒ…

```
npm unpublish åŒ…å --force
```

### CNPM

#### ä»‹ç»

cnpm æ˜¯æ·˜å®å¯¹å›½å¤– npm æœåŠ¡å™¨çš„ä¸€ä¸ªå®Œæ•´é•œåƒç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æ·˜å® npm é•œåƒï¼Œç½‘ç«™åœ°å€<http://npm.taobao.org/>

#### å®‰è£…

å®‰è£…é…ç½®æ–¹å¼æœ‰ä¸¤ç§

* npm install -g cnpm --registry=https://registry.npm.taobao.org
* alias cnpm="npm --registry=https://registry.npm.taobao.org \
  --cache=$HOME/.npm/.cache/cnpm \
  --disturl=https://npm.taobao.org/dist \
  --userconfig=$HOME/.cnpmrc"       (åªèƒ½åœ¨Linuxä¸‹ä½¿ç”¨)

#### ä½¿ç”¨

é…ç½®å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨ cnpm å‘½ä»¤æ¥ç®¡ç†åŒ…ï¼Œä½¿ç”¨æ–¹æ³•è·Ÿ npm ä¸€æ ·

```sh
cnpm install lodash
```

#### npm é…ç½®é•œåƒåœ°å€

```sh
//æ·˜å®é•œåƒ
npm config set registry https://registry.npm.taobao.org
//å®˜æ–¹é•œåƒ   
npm config set registry https://registry.npmjs.org/
```

> åœ¨å‘å¸ƒå·¥å…·çš„æ—¶å€™, ä¸€å®šè¦å°†é•œåƒåœ°å€, ä¿®æ”¹ä¸ºå®˜æ–¹çš„åœ°å€

### Yarn

#### ä»‹ç»

yarn æ˜¯ Facebook å¼€æºçš„æ–°çš„åŒ…ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿ npmã€‚

#### ç‰¹ç‚¹

yarn ç›¸æ¯”äº npm æœ‰å‡ ä¸ªç‰¹ç‚¹

* æœ¬åœ°ç¼“å­˜ã€‚å®‰è£…è¿‡çš„åŒ…ä¸‹æ¬¡ä¸ä¼šè¿›è¡Œè¿œç¨‹å®‰è£…
* å¹¶è¡Œä¸‹è½½ã€‚ä¸€æ¬¡ä¸‹è½½å¤šä¸ªåŒ…ï¼Œè€Œ npm æ˜¯ä¸²è¡Œä¸‹è½½
* ç²¾å‡†çš„ç‰ˆæœ¬æ§åˆ¶ã€‚ä¿è¯æ¯æ¬¡å®‰è£…è·Ÿä¸Šæ¬¡éƒ½æ˜¯ä¸€æ ·çš„

#### å®‰è£…

##### yarn å®‰è£…

åªéœ€è¦ä¸€è¡Œå‘½ä»¤å³å¯å®‰è£… yarn

```sh
npm install yarn -g
```

##### msi å®‰è£…åŒ…å®‰è£…

<https://classic.yarnpkg.com/en/docs/install#windows-stable>

#### ç›¸å…³å‘½ä»¤

yarn çš„ç›¸å…³å‘½ä»¤

1)  yarn -v

2)  yarn init  //ç”Ÿæˆpackage.json   

3)  yarn global add  package   å…¨å±€å®‰è£…

â€‹	å…¨å±€å®‰è£…è·¯å¾„ `C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Yarn\bin`

4)  yarn global remove less  (å…¨å±€åˆ é™¤)

5)  yarn add package  (å±€éƒ¨å®‰è£…)

6)  yarn add package --dev   (ç›¸å½“äºnpmä¸­çš„--save-dev)

7)  yarn remove package  ç§»é™¤

8)  yarn list  //åˆ—å‡ºå·²ç»å®‰è£…çš„åŒ…å ç”¨çš„å¾ˆå°‘

9)  yarn  //å®‰è£… package.json ä¸­çš„æ‰€æœ‰ä¾èµ– 

> npm 5 å¼•å…¥ç¦»çº¿ç¼“å­˜ï¼Œæé«˜äº†å®‰è£…é€Ÿåº¦ï¼Œä¹Ÿå¼•å…¥äº† package-lock.json æ–‡ä»¶å¢å¼ºäº†ç‰ˆæœ¬æ§åˆ¶

yarn ä¿®æ”¹ä»“åº“åœ°å€

```sh
yarn config set registry https://registry.npm.taobao.org
```

### CYarn

è·Ÿ npm ä¸ cnpm çš„å…³ç³»ä¸€æ ·ï¼Œå¯ä»¥ä¸º yarn è®¾ç½®å›½å†…çš„æ·˜å®é•œåƒï¼Œæå‡å®‰è£…çš„é€Ÿåº¦

```sh
npm install cyarn -g --registry "https://registry.npm.taobao.org"
```

é…ç½®åï¼Œåªéœ€å°†yarnæ”¹ä¸ºcyarnä½¿ç”¨å³å¯

### é™„å½•

å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„å·¥å…·åŒ…

```shell
yarn add jquery@1.11.2
```

npm æ¸…é™¤ç¼“å­˜. (npmå‘½ä»¤,æ˜æ˜æ²¡æœ‰é”™è¯¯, ä½†æ˜¯å°±æ˜¯å®‰è£…å¤±è´¥, æ­¤æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤)

```
npm cache clean --force
```

æŸ¥çœ‹å…¨å±€å®‰è£…çš„ä½ç½®

npm

```
npm root -g
```

yarn

```
yarn global dir
```

npm è¿è¡Œè„šæœ¬

1. package.json ä¸­çš„ `scripts` æ–°å»ºä¸€ä¸ªå±æ€§

   ```json
   {
   	.
   	.
   	.
       "scripts": {
           "test": "echo \"Error: no test specified\" && exit 1",
           "server": "node server.js"
        },
        .
        .
        .
   }
   ```

2. å‘½ä»¤è¡Œä¸­ä½¿ç”¨ npm å¯åŠ¨æœåŠ¡

   ```
   npm run server 
   ```

   